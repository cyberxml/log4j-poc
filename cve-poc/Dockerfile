
FROM codenvy/jdk8_maven3_tomcat8

COPY --chown=user:user files /

RUN sudo sh -c 'printf "deb [trusted=yes] http://archive.debian.org/debian/ jessie main\ndeb-src http://archive.debian.org/debian/ jessie main\ndeb [trusted=yes] http://security.debian.org jessie/updates main\ndeb-src http://security.debian.org jessie/updates main" > /etc/apt/sources.list'

RUN sudo apt -yq update && sudo apt -yq install python3 netcat vim tcpdump

USER user

WORKDIR /home/user

RUN cd rmi-poc && \
    javac -cp catalina.jar:. RMIServerPOC.java

EXPOSE 22/tcp 

CMD ["/entrypoint.sh"]
